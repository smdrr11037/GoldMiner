# 中期总结
---------
## 每轮迭代情况说明（model补充在后面
- 第一轮迭代：window实现三个窗口之间的切换，实现鼠标点击按键交互和分数等Label的显示
- 第二轮迭代：window实现游戏中界面显示单个金块和钩子图片，初步实现绘制线条功能，并实现游戏中界面与键盘的交互
- 第三轮迭代：可以根据指针暴露的Blocks属性画出地图上的所有金块，实现钩子正确旋转以及绳子与钩子末端的连接
- 第四轮迭代：优化UI界面，调整参数，使游戏界面更顺畅合理
## 技术难点及克服

### 框架搭建过程中的困难

1. Qt 框架下如何实现数据绑定


### view 层实现过程遇到的困难
1. Qt库的使用
以前没有接触过Qt库，刚开始使用时显得很生涩，好在Qt库的使用并非十分困难，代码撰写过程中慢慢熟练了。
2. 不同窗口之间的切换
起初实现窗口切换时采用三个窗口分别 setCentralWidget ，但在想要再次显示已显示窗口时应该是由于 setCentralWidget 函数的性质，会导致程序发生段错误而异常退出；
后续采用stackedWidget来实现不同窗口的切换。
3. 布局管理器的使用
需要 layout->addStretch(1) 添加弹簧，将按钮推到底部，否则页面布局会非常迥异。
4. 绘制线条（绳子）的实现
起初想尝试用 Qt 库 QGraphicsLineItem 来实现绘制线条，但绘制出来的线条总是会携带画布，覆盖我的游戏界面；
最后采用重写 QWidget 的 paintEvent 函数的方法，在现有的布局管理器中添加一条线，而不会在布局中留下额外的空白区域。
5. 键盘交互
起初交互过程中出现无法响应键盘的情况，通过 setFocusPolicy(Qt::StrongFocus) 设置部件（widget）的焦点，用户可以直接与部件进行交互，而不需要额外的操作来激活部件的焦点。
6. 刷新页面时多个金块的重复显示
刷新页面重绘所有金块和石块时，会出现“重影”，即上一次画的没有被擦除；
增加 clearBlocks 函数，每次刷新页面时先调用 clearBlocks 擦除上次显示的金块。
7. 钩子旋转和绳子连接
起初一直未能依靠 Qt 库函数实现：
1.Hook 的旋转
2.旋转之后有一部分钩子图像无法正常显示
3.Hook 图片旋转后钩子末端坐标改变，使得“绳子连接到钩子末端”变得难以实现
解决方法：
1.创建一个新的QPixmap，用于旋转后的图像
QPixmap rotatedPixmap(w, h);
rotatedPixmap.fill(Qt::transparent);
QPainter painter(&rotatedPixmap);
painter.setRenderHint(QPainter::Antialiasing, true);
2.将绘图原点平移到钩子末端处  
painter.translate(w/2, h / 4);
3.进行旋转  
painter.rotate(rotationAngle);
4.绘制旋转后的图像  
painter.drawPixmap(0, 0, hookImage);
painter.end();
5.最后根据 Hook 坐标绘制线条，实现绳子和钩子的无缝连接。

### model 层实现过程遇到的困难



## 协作情况

前四轮迭代中，我们的分工如下

薛柔：搭建项目框架，负责App层
姚懿宸：负责View层和Window层
朱熙哲：负责Model层和ViewModel层

## 部分效果图


## 总体心得



## 个人心得
- 姚懿宸
  1. MVVM框架有良好的可测试性，我负责的view模块只需要负责展示数据和用户交互，视图模型可以独立进行单元测试，以确保视图模型的行为符合预期。而且MVVM框架解耦合性很强，视图模型充当了视图和模型之间的中介，减少视图和模型之间的耦合，当一个部分发生变化时，其他部分通常不需要做出大的修改。数据绑定：MVVM框架支持双向数据绑定，视图可以直接与视图模型中的数据进行绑定，从而使得界面的更新更简单高效。
  2. 这是我首次经历系统性团队多人协作开发软件的过程，受益匪浅。和我们以前的团队合作不同，在采用的工具方面，Github代码托管方便了我们进行代码的版本控制，我也感受到了 git 相比于从前使用微信反复发送压缩文件来交换代码的方便和优越之处。